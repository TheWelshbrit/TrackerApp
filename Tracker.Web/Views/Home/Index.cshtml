@{
    ViewData["Title"] = "Home Page";
}
@model Tracker.Web.ViewModels.Home.IndexViewModel

<style>
.modal {
    position: fixed;
    z-index: 999;
    left: 0; top: 0;
    width: 100%; height: 100%;
    background: rgba(0, 0, 0, 0.4);
}
.modal-content {
    background: #fff;
    padding: 1em;
    margin: 10% auto;
    width: 300px;
    border-radius: 5px;
}
</style>

<h2>Day In Progress <a href="/Home/CompleteDayInProgress" class="btn btn-sm btn-outline-primary">Complete Day</a></h2>
<div style="border: 2px dashed #ffa; margin: 2em 0; padding: 1em; background-color: #fffce0;">
    <div style="border: 1px solid #ccc; margin: 1em 0; padding: 1em;">
        <h3>@Model.DayInProgress.RecordDate  <button onclick="openModal('ChangeDate', 'UpdateDayInProgressDate', 'Change Day In Progress Date')" class="btn btn-sm btn-outline-primary">Change Date</button></h3>

        <h4>AI Summary</h4>
        <p><strong>Quote:</strong> @Model.DayInProgress.AiDailyOverview?.AiQuote</p>
        <p><strong>Note:</strong> @Model.DayInProgress.AiDailyOverview?.AiNote</p>

        <h4>Mood Notes <button onclick="openModal('NewNoteRecord', 'AddMoodNote', 'Add Mood Note')" class="btn btn-sm btn-outline-primary">+</button></h4>
        <ul>
            @foreach (var note in Model.DayInProgress.MoodNotes)
            {
                <li>@note.TimeNoteMade?.ToShortTimeString(): @note.Note</li>
            }
        </ul>

        <h4>Context Notes <button onclick="openModal('NewNoteRecord', 'AddContextNote', 'Add Context Note')" class="btn btn-sm btn-outline-primary">+</button></h4>
        <ul>
            @foreach (var note in Model.DayInProgress.ContextNotes)
            {
                <li>@note.TimeNoteMade?.ToShortTimeString(): @note.Note</li>
            }
        </ul>

        <h4>Sleep <button onclick="openModal('NewSleepRecord', 'AddSleepRecord', 'Add Sleep Record')" class="btn btn-sm btn-outline-primary">+</button></h4>
        <ul>
            @foreach (var s in Model.DayInProgress.SleepRecords)
            {
                <li>
                    <strong>@s.SleepType</strong>: @s.SleepAttemptStartTime.ToShortTimeString() – @s.SleepAttemptEndTime.ToShortTimeString()  
                    (Estimated sleep: @s.EstimatedActualSleepDuration hrs)  
                    <em>@s.Note</em>
                </li>
            }
        </ul>

        <h4>Hygeine <button onclick="openModal('NewShowerActivity', 'AddShowerActivity', 'Add Shower Record')" class="btn btn-sm btn-outline-primary">+ Shower</button><button onclick="openModal('NewGenericInstanceRecord', 'AddToothBrushingActivity', 'Add Teeth Cleaning Record')" class="btn btn-sm btn-outline-primary">+ Teeth Cleaning</button><button onclick="openModal('NewNoteRecord', 'AddHygeineNote', 'Add General Hygeine Note')" class="btn btn-sm btn-outline-primary">+ Hygeine Note</button></h4>
        <p>Teeth Cleaned: @string.Join(", ", Model.DayInProgress.Hygeine.TeethCleaningInstances.Select(t => $"[{((DateTime)(t.TimeStarted ?? new DateTime())).ToShortTimeString()} => {((DateTime)(t.TimeEnded ?? new DateTime())).ToShortTimeString()} : {t.Note}]"))</p>
        <p>Shower Count: @Model.DayInProgress.Hygeine.ShowerInstances.Count</p>
        <ul>
            @foreach (var note in Model.DayInProgress.Hygeine.HygeineNotes)
            {
                <li>@note.TimeNoteMade?.ToShortTimeString(): @note.Note</li>
            }
        </ul>

        <h4>Food <button onclick="openModal('NewFoodRecord', 'AddFoodRecord', 'Add Food Record')" class="btn btn-sm btn-outline-primary">+</button></h4>
        <ul>
            @foreach (var f in Model.DayInProgress.FoodRecords)
            {
                <li><strong>@f.FoodType</strong>: @f.Food @f.TimeStartedEating?.ToShortTimeString() <em>@f.Note</em></li>
            }
        </ul>

        <h4>Drinks <button onclick="openModal('NewDrinkRecord', 'AddDrinkRecord', 'Add Drink Record')" class="btn btn-sm btn-outline-primary">+</button></h4>
        <ul>
            @foreach (var d in Model.DayInProgress.DrinkRecords)
            {
                <li>@d.TimeStartedDrinking?.ToShortTimeString(): @d.Drink, @d.Quantity @d.QuantityMeasurement (@(d.Alcoholic ? $"Alcohol: {d.AlcoholPercentage}%" : "Non-alcoholic")) <em>@d.Note</em></li>
            }
        </ul>

        <h4>Work <button onclick="openModal('NewGenericActivityRecord', 'AddWorkActivity', 'Add Work Record')" class="btn btn-sm btn-outline-primary">+</button></h4>
        <p>Location: @Model.DayInProgress.WorkDayRecord.Location, Hours: @Model.DayInProgress.WorkDayRecord.TotalHours</p>
        <ul>
            @foreach (var note in Model.DayInProgress.WorkDayRecord.OverallNotes)
            {
                <li>@note.TimeNoteMade?.ToShortTimeString(): @note.Note</li>
            }
        </ul>
        <ul>
            @foreach (var activity in Model.DayInProgress.WorkDayRecord.WorkActivities)
            {
                <li>@activity.StartTime.ToShortTimeString()–@activity.EndTime.ToShortTimeString(): @activity.Activity <em>@activity.Note</em></li>
            }
        </ul>

        <h4>Exercise <button onclick="openModal('NewExcerciseRecord', 'AddExcerciseActivity', 'Add Excercise Record')" class="btn btn-sm btn-outline-primary">+</button></h4>
        <ul>
            @foreach (var ex in Model.DayInProgress.ExerciseSessions)
            {
                <li><strong>@ex.Type</strong>: @ex.Activity @ex.StartTime.ToShortTimeString()–@ex.EndTime.ToShortTimeString() <em>@ex.Note</em></li>
            }
        </ul>

        <h4>Gaming <button onclick="openModal('NewGamingRecord', 'AddGamingActivity', 'Add Gaming Record')" class="btn btn-sm btn-outline-primary">+</button></h4>
        <ul>
            @foreach (var g in Model.DayInProgress.GamingSessions)
            {
                <li>@g.Game: @g.StartTime.ToShortTimeString()–@g.EndTime.ToShortTimeString(), With: @string.Join(", ", g.PeoplePlayedWith) <em>@g.Note</em></li>
            }
        </ul>

        <h4>Piano <button onclick="openModal('NewGenericActivityRecord', 'AddPianoActivity', 'Add Piano Record')" class="btn btn-sm btn-outline-primary">+</button></h4>
        <ul>
            @foreach (var p in Model.DayInProgress.PianoRecords)
            {
                <li>@p.StartTime.ToShortTimeString()–@p.EndTime.ToShortTimeString(): @p.Activity <em>@p.Note</em></li>
            }
        </ul>

        <h4>Chores <button onclick="openModal('NewGenericActivityRecord', 'AddChoreActivity', 'Add Chore Record')" class="btn btn-sm btn-outline-primary">+</button></h4>
        <ul>
            @foreach (var c in Model.DayInProgress.ChoreActivities)
            {
                <li>@c.StartTime.ToShortTimeString()–@c.EndTime.ToShortTimeString(): @c.Activity <em>@c.Note</em></li>
            }
        </ul>

        <h4>Chat with GPT <button onclick="openModal('NewGenericActivityRecord', 'AddGptChatActivity', 'Add GptChat Record')" class="btn btn-sm btn-outline-primary">+</button></h4>
        <ul>
            @foreach (var chat in Model.DayInProgress.GptChatActivities)
            {
                <li>@chat.StartTime.ToShortTimeString()–@chat.EndTime.ToShortTimeString(): @chat.Activity <em>@chat.Note</em></li>
            }
        </ul>

        <h4>Other <button onclick="openModal('NewGenericActivityRecord', 'AddOtherActivity', 'Add Other Activity Record')" class="btn btn-sm btn-outline-primary">+</button></h4>
        <ul>
            @foreach (var o in Model.DayInProgress.OtherActivities)
            {
                <li>@o.StartTime.ToShortTimeString()–@o.EndTime.ToShortTimeString(): @o.Activity <em>@o.Note</em></li>
            }
        </ul>
    </div>
</div>


<h2>Daily Tracker Entries</h2>

@foreach (var day in Model.DayRecords.OrderByDescending(d => d.RecordDate))
{
    <div style="border: 1px solid #ccc; margin: 1em 0; padding: 1em;">
        <h3>@day.RecordDate</h3>

        <h4>AI Summary</h4>
        <p><strong>Quote:</strong> @day.AiDailyOverview?.AiQuote</p>
        <p><strong>Note:</strong> @day.AiDailyOverview?.AiNote</p>

        <h4>Mood Notes</h4>
        <ul>
            @foreach (var note in day.MoodNotes)
            {
                <li>@note.TimeNoteMade?.ToShortTimeString(): @note.Note</li>
            }
        </ul>

        <h4>Context Notes</h4>
        <ul>
            @foreach (var note in day.ContextNotes)
            {
                <li>@note.TimeNoteMade?.ToShortTimeString(): @note.Note</li>
            }
        </ul>

        <h4>Sleep</h4>
        <ul>
            @foreach (var s in day.SleepRecords)
            {
                <li>
                    <strong>@s.SleepType</strong>: @s.SleepAttemptStartTime.ToShortTimeString() – @s.SleepAttemptEndTime.ToShortTimeString()  
                    (Estimated sleep: @s.EstimatedActualSleepDuration hrs)  
                    <em>@s.Note</em>
                </li>
            }
        </ul>

        <h4>Hygeine</h4>
        <p>Teeth Cleaned: @string.Join(", ", day.Hygeine.TeethCleaningInstances.Select(t => $"[{((DateTime)(t.TimeStarted ?? new DateTime())).ToShortTimeString()} => {((DateTime)(t.TimeEnded ?? new DateTime())).ToShortTimeString()} : {t.Note}]"))</p>
        <p>Shower Count: @day.Hygeine.ShowerInstances.Count</p>
        <ul>
            @foreach (var note in day.Hygeine.HygeineNotes)
            {
                <li>@note.TimeNoteMade?.ToShortTimeString(): @note.Note</li>
            }
        </ul>

        <h4>Food</h4>
        <ul>
            @foreach (var f in day.FoodRecords)
            {
                <li><strong>@f.FoodType</strong>: @f.Food @f.TimeStartedEating?.ToShortTimeString() <em>@f.Note</em></li>
            }
        </ul>

        <h4>Drinks</h4>
        <ul>
            @foreach (var d in day.DrinkRecords)
            {
                <li>@d.TimeStartedDrinking?.ToShortTimeString(): @d.Drink, @d.Quantity @d.QuantityMeasurement (@(d.Alcoholic ? $"Alcohol: {d.AlcoholPercentage}%" : "Non-alcoholic")) <em>@d.Note</em></li>
            }
        </ul>

        <h4>Work</h4>
        <p>Location: @day.WorkDayRecord.Location, Hours: @day.WorkDayRecord.TotalHours</p>
        <ul>
            @foreach (var note in day.WorkDayRecord.OverallNotes)
            {
                <li>@note.TimeNoteMade?.ToShortTimeString(): @note.Note</li>
            }
        </ul>
        <ul>
            @foreach (var activity in day.WorkDayRecord.WorkActivities)
            {
                <li>@activity.StartTime.ToShortTimeString()–@activity.EndTime.ToShortTimeString(): @activity.Activity <em>@activity.Note</em></li>
            }
        </ul>

        <h4>Exercise</h4>
        <ul>
            @foreach (var ex in day.ExerciseSessions)
            {
                <li><strong>@ex.Type</strong>: @ex.Activity @ex.StartTime.ToShortTimeString()–@ex.EndTime.ToShortTimeString() <em>@ex.Note</em></li>
            }
        </ul>

        <h4>Gaming</h4>
        <ul>
            @foreach (var g in day.GamingSessions)
            {
                <li>@g.Game: @g.StartTime.ToShortTimeString()–@g.EndTime.ToShortTimeString(), With: @string.Join(", ", g.PeoplePlayedWith) <em>@g.Note</em></li>
            }
        </ul>

        <h4>Piano</h4>
        <ul>
            @foreach (var p in day.PianoRecords)
            {
                <li>@p.StartTime.ToShortTimeString()–@p.EndTime.ToShortTimeString(): @p.Activity <em>@p.Note</em></li>
            }
        </ul>

        <h4>Chores</h4>
        <ul>
            @foreach (var c in day.ChoreActivities)
            {
                <li>@c.StartTime.ToShortTimeString()–@c.EndTime.ToShortTimeString(): @c.Activity <em>@c.Note</em></li>
            }
        </ul>

        <h4>Chat with GPT</h4>
        <ul>
            @foreach (var chat in day.GptChatActivities)
            {
                <li>@chat.StartTime.ToShortTimeString()–@chat.EndTime.ToShortTimeString(): @chat.Activity <em>@chat.Note</em></li>
            }
        </ul>

        <h4>Other</h4>
        <ul>
            @foreach (var o in day.OtherActivities)
            {
                <li>@o.StartTime.ToShortTimeString()–@o.EndTime.ToShortTimeString(): @o.Activity <em>@o.Note</em></li>
            }
        </ul>
    </div>
}

@Html.Partial("~/Views/Partials/DataEntryModals.cshtml")
